
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Synapses</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen-b94ebdc6.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-bccf8c07.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-c5541673.js"></script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;,&quot;java&quot;,&quot;scala&quot;,&quot;fsharp&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-9f333ef1.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
              <a href="#" data-language-name="java">java</a>
              <a href="#" data-language-name="scala">scala</a>
              <a href="#" data-language-name="fsharp">fsharp</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#synapses" class="toc-h1 toc-link" data-title="Synapses">Synapses</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#neural-network" class="toc-h2 toc-link" data-title="Neural Network">Neural Network</a>
                  </li>
                  <li>
                    <a href="#save-and-load-a-neural-network" class="toc-h2 toc-link" data-title="Save and load a neural network">Save and load a neural network</a>
                  </li>
                  <li>
                    <a href="#encoding-and-decoding" class="toc-h2 toc-link" data-title="Encoding and decoding">Encoding and decoding</a>
                  </li>
                  <li>
                    <a href="#evaluation" class="toc-h2 toc-link" data-title="Evaluation">Evaluation</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://github.com/mrdimosthenis/Synapses'>GitHub Repository</a></li>
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
            <li><a href='https://pngimage.net/icono-cerebro-png-5'> Logo Attribution </a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='synapses'>Synapses</h1>
<p><strong>Synapses</strong> is a lightweight <strong>Neural Network</strong> library, for <strong>js</strong>, <strong>jvm</strong> and <strong>.net</strong>.</p>
<pre class="highlight javascript tab-javascript"><code><span class="c1">// run</span>
<span class="nx">npm</span> <span class="nx">i</span> <span class="nx">synapses</span><span class="p">@</span><span class="nd">7</span><span class="p">.</span><span class="mf">1.0</span>
<span class="c1">// in the directory of your node project</span>
</code></pre><pre class="highlight java tab-java"><code><span class="c1">// add</span>
<span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">com</span><span class="o">.</span><span class="na">github</span><span class="o">.</span><span class="na">mrdimosthenis</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">synapses_2</span><span class="o">.</span><span class="mi">13</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="mf">7.1</span><span class="o">.</span><span class="mi">0</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
<span class="c1">// to pom.xml</span>
</code></pre><pre class="highlight scala tab-scala"><code><span class="c1">// add
</span><span class="n">libraryDependencies</span> <span class="o">+=</span>
  <span class="s">"com.github.mrdimosthenis"</span> <span class="o">%%</span> <span class="s">"synapses"</span> <span class="o">%</span> <span class="s">"7.1.1"</span>
<span class="c1">// to build.sbt
</span></code></pre><pre class="highlight fsharp tab-fsharp"><code><span class="c1">// run
</span><span class="n">dotnet</span> <span class="n">add</span> <span class="n">package</span> <span class="nc">Synapses</span> <span class="o">--</span><span class="n">version</span> <span class="mi">7</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span>
<span class="c1">// in the directory of your project
</span></code></pre><h2 id='neural-network'>Neural Network</h2><h3 id='create-a-neural-network'>Create a neural network</h3>
<p>Import <code>Synapses</code>, call <code>NeuralNetwork.init</code> and provide the size of each <em>layer</em>.</p>
<pre class="highlight javascript tab-javascript"><code><span class="nx">require</span><span class="p">(</span><span class="s1">'synapses'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">layers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
<span class="kd">let</span> <span class="nx">neuralNetwork</span> <span class="o">=</span> <span class="nx">NeuralNetwork</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">layers</span><span class="p">);</span>
</code></pre><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">synapses.jvm.library.*</span><span class="o">;</span>
<span class="kt">int</span><span class="o">[]</span> <span class="n">layers</span> <span class="o">=</span> <span class="o">{</span><span class="mi">4</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">3</span><span class="o">};</span>
<span class="n">NeuralNetwork</span> <span class="n">neuralNetwork</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">layers</span><span class="o">);</span>
</code></pre><pre class="highlight scala tab-scala"><code><span class="k">import</span> <span class="nn">synapses.Library._</span>
<span class="k">val</span> <span class="n">layers</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="k">val</span> <span class="n">neuralNetwork</span> <span class="k">=</span> <span class="nc">NeuralNetwork</span><span class="o">.</span><span class="n">init</span><span class="o">(</span><span class="n">layers</span><span class="o">)</span>
</code></pre><pre class="highlight fsharp tab-fsharp"><code><span class="k">open</span> <span class="nc">Synapses</span>
<span class="k">let</span> <span class="n">layers</span> <span class="p">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">;</span> <span class="mi">6</span><span class="p">;</span> <span class="mi">5</span><span class="p">;</span> <span class="mi">3</span><span class="p">]</span>
<span class="k">let</span> <span class="n">neuralNetwork</span> <span class="p">=</span> <span class="nn">NeuralNetwork</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span>
</code></pre>
<p><code>neuralNetwork</code> has 4 layers. The first layer has 4 input nodes and the last layer has 3 output nodes.
There are 2 hidden layers with 6 and 5 neurons respectively.</p>
<h3 id='get-a-prediction'>Get a prediction</h3><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">inputValues</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5625</span><span class="p">,</span> <span class="mf">0.511111</span><span class="p">,</span> <span class="mf">0.47619</span><span class="p">];</span>
<span class="kd">let</span> <span class="nx">prediction</span> <span class="o">=</span>
        <span class="nx">NeuralNetwork</span><span class="p">.</span><span class="nx">prediction</span><span class="p">(</span><span class="nx">neuralNetwork</span><span class="p">,</span> <span class="nx">inputValues</span><span class="p">);</span>
</code></pre><pre class="highlight java tab-java"><code><span class="kt">double</span><span class="o">[]</span> <span class="n">inputValues</span> <span class="o">=</span> <span class="o">{</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">0.5625</span><span class="o">,</span> <span class="mf">0.511111</span><span class="o">,</span> <span class="mf">0.47619</span><span class="o">};</span>
<span class="kt">double</span><span class="o">[]</span> <span class="n">prediction</span> <span class="o">=</span>
    <span class="n">NeuralNetwork</span><span class="o">.</span><span class="na">prediction</span><span class="o">(</span><span class="n">neuralNetwork</span><span class="o">,</span> <span class="n">inputValues</span><span class="o">);</span>
</code></pre><pre class="highlight scala tab-scala"><code><span class="k">val</span> <span class="n">inputValues</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">0.5625</span><span class="o">,</span> <span class="mf">0.511111</span><span class="o">,</span> <span class="mf">0.47619</span><span class="o">)</span>
<span class="k">val</span> <span class="n">prediction</span> <span class="k">=</span>
        <span class="nc">NeuralNetwork</span><span class="o">.</span><span class="n">prediction</span><span class="o">(</span><span class="n">neuralNetwork</span><span class="o">,</span> <span class="n">inputValues</span><span class="o">)</span>
</code></pre><pre class="highlight fsharp tab-fsharp"><code><span class="k">let</span> <span class="n">inputValues</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5625</span><span class="p">;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">511111</span><span class="p">;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">47619</span><span class="p">]</span>
<span class="k">let</span> <span class="n">prediction</span> <span class="p">=</span>
        <span class="nn">NeuralNetwork</span><span class="p">.</span><span class="n">prediction</span><span class="p">(</span><span class="n">neuralNetwork</span><span class="p">,</span> <span class="n">inputValues</span><span class="p">)</span>
</code></pre>
<p><code>prediction</code> should be something like <code>[ 0.8296, 0.6996, 0.4541 ]</code>.</p>

<aside class="success">
Note that the lengths of inputValues and prediction equal to the sizes of input and output layers respectively.
</aside>
<h3 id='fit-network'>Fit network</h3><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">learningRate</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">expectedOutput</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">];</span>
<span class="kd">let</span> <span class="nx">fitNetwork</span> <span class="o">=</span>
        <span class="nx">NeuralNetwork</span><span class="p">.</span><span class="nx">fit</span><span class="p">(</span>
            <span class="nx">neuralNetwork</span><span class="p">,</span>
            <span class="nx">learningRate</span><span class="p">,</span>
            <span class="nx">inputValues</span><span class="p">,</span>
            <span class="nx">expectedOutput</span>
        <span class="p">);</span>
</code></pre><pre class="highlight java tab-java"><code><span class="kt">double</span> <span class="n">learningRate</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">;</span>
<span class="kt">double</span><span class="o">[]</span> <span class="n">expectedOutput</span> <span class="o">=</span> <span class="o">{</span><span class="mf">0.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">};</span>
<span class="n">NeuralNetwork</span> <span class="n">fitNetwork</span> <span class="o">=</span>
    <span class="n">NeuralNetwork</span><span class="o">.</span><span class="na">fit</span><span class="o">(</span>
        <span class="n">neuralNetwork</span><span class="o">,</span>
        <span class="n">learningRate</span><span class="o">,</span>
        <span class="n">inputValues</span><span class="o">,</span>
        <span class="n">expectedOutput</span>
    <span class="o">);</span>
</code></pre><pre class="highlight scala tab-scala"><code><span class="k">val</span> <span class="n">learningRate</span> <span class="k">=</span> <span class="mf">0.5</span>
<span class="k">val</span> <span class="n">expectedOutput</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mf">0.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">)</span>
<span class="k">val</span> <span class="n">fitNetwork</span> <span class="k">=</span>
        <span class="nc">NeuralNetwork</span><span class="o">.</span><span class="n">fit</span><span class="o">(</span>
            <span class="n">neuralNetwork</span><span class="o">,</span>
            <span class="n">learningRate</span><span class="o">,</span>
            <span class="n">inputValues</span><span class="o">,</span>
            <span class="n">expectedOutpu</span>
        <span class="o">)</span>
</code></pre><pre class="highlight fsharp tab-fsharp"><code><span class="k">let</span> <span class="n">learningRate</span> <span class="p">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span>
<span class="k">let</span> <span class="n">expectedOutput</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">]</span>
<span class="k">let</span> <span class="n">fitNetwork</span> <span class="p">=</span>
        <span class="nn">NeuralNetwork</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">neuralNetwork</span><span class="p">,</span>
            <span class="n">learningRate</span><span class="p">,</span>
            <span class="n">inputValues</span><span class="p">,</span>
            <span class="n">expectedOutput</span>
        <span class="p">)</span>
</code></pre>
<p><code>fitNetwork</code> is a new neural network trained with a single observation.</p>

<blockquote>
<p>to train a neural network, you should fit with multiple datapoints</p>
</blockquote>
<h3 id='create-a-customized-neural-network'>Create a customized neural network</h3>
<p>The <em>activation function</em> of the neurons created with <code>NeuralNetwork.init</code>, is a sigmoid one.
If you want to customize the <em>activation functions</em> and the <em>weight distribution</em>, call <code>NeuralNetwork.customizedInit</code>.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kd">function</span> <span class="nx">activationF</span><span class="p">(</span><span class="nx">layerIndex</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">layerIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nx">ActivationFunction</span><span class="p">.</span><span class="nx">sigmoid</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="nx">ActivationFunction</span><span class="p">.</span><span class="nx">identity</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="nx">ActivationFunction</span><span class="p">.</span><span class="nx">leakyReLU</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="nx">ActivationFunction</span><span class="p">.</span><span class="nx">tanh</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">weightInitF</span><span class="p">(</span><span class="nx">_layerIndex</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">customizedNetwork</span> <span class="o">=</span>
        <span class="nx">NeuralNetwork</span><span class="p">.</span><span class="nx">customizedInit</span><span class="p">(</span>
            <span class="nx">layers</span><span class="p">,</span>
            <span class="nx">activationF</span><span class="p">,</span>
            <span class="nx">weightInitF</span>
        <span class="p">);</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">ActivationFunction</span> <span class="nf">activationF</span><span class="o">(</span><span class="kt">int</span> <span class="n">layerIndex</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">switch</span> <span class="o">(</span><span class="n">layerIndex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
            <span class="k">return</span> <span class="n">ActivationFunction</span><span class="o">.</span><span class="na">sigmoid</span><span class="o">();</span>
        <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
            <span class="k">return</span> <span class="n">ActivationFunction</span><span class="o">.</span><span class="na">identity</span><span class="o">();</span>
        <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
            <span class="k">return</span> <span class="n">ActivationFunction</span><span class="o">.</span><span class="na">leakyReLU</span><span class="o">();</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">return</span> <span class="n">ActivationFunction</span><span class="o">.</span><span class="na">tanh</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kt">double</span> <span class="nf">weightInitF</span><span class="o">(</span><span class="kt">int</span> <span class="n">_layerIndex</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Random</span> <span class="n">rnd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">rnd</span><span class="o">.</span><span class="na">nextDouble</span><span class="o">();</span>
<span class="o">}</span>

<span class="n">NeuralNetwork</span> <span class="n">customizedNetwork</span> <span class="o">=</span>
    <span class="n">NeuralNetwork</span><span class="o">.</span><span class="na">customizedInit</span><span class="o">(</span>
        <span class="n">layers</span><span class="o">,</span>
        <span class="k">this</span><span class="o">::</span><span class="n">activationF</span><span class="o">,</span>
        <span class="k">this</span><span class="o">::</span><span class="n">weightInitF</span>
    <span class="o">);</span>
</code></pre><pre class="highlight scala tab-scala"><code><span class="k">def</span> <span class="n">activationF</span><span class="o">(</span><span class="n">layerIndex</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">ActivationFunction</span> <span class="o">=</span>
  <span class="n">layerIndex</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="mi">0</span> <span class="k">=&gt;</span> <span class="nc">ActivationFunction</span><span class="o">.</span><span class="n">sigmoid</span>
    <span class="k">case</span> <span class="mi">1</span> <span class="k">=&gt;</span> <span class="nc">ActivationFunction</span><span class="o">.</span><span class="n">identity</span>
    <span class="k">case</span> <span class="mi">2</span> <span class="k">=&gt;</span> <span class="nc">ActivationFunction</span><span class="o">.</span><span class="n">leakyReLU</span>
    <span class="k">case</span> <span class="mi">3</span> <span class="k">=&gt;</span> <span class="nc">ActivationFunction</span><span class="o">.</span><span class="n">tanh</span>
  <span class="o">}</span>

<span class="k">def</span> <span class="n">weightInitF</span><span class="o">(</span><span class="nc">_layerIndex</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span>
        <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="n">nextDouble</span><span class="o">()</span>

<span class="k">val</span> <span class="n">customizedNetwork</span> <span class="k">=</span>
        <span class="nc">NeuralNetwork</span><span class="o">.</span><span class="n">customizedInit</span><span class="o">(</span>
            <span class="n">layers</span><span class="o">,</span>
            <span class="n">activationF</span><span class="o">,</span>
            <span class="n">weightInitF</span>
        <span class="o">)</span>
</code></pre><pre class="highlight fsharp tab-fsharp"><code><span class="k">let</span> <span class="n">activationF</span> <span class="p">(</span><span class="n">layerIndex</span><span class="p">:</span> <span class="kt">int</span><span class="p">)</span>
        <span class="p">:</span> <span class="nc">ActivationFunction</span> <span class="p">=</span>
        <span class="k">match</span> <span class="n">layerIndex</span> <span class="k">with</span>
        <span class="p">|</span> <span class="mi">0</span> <span class="p">-&gt;</span> <span class="nn">ActivationFunction</span><span class="p">.</span><span class="n">sigmoid</span>
        <span class="p">|</span> <span class="mi">1</span> <span class="p">-&gt;</span> <span class="nn">ActivationFunction</span><span class="p">.</span><span class="n">tanh</span>
        <span class="p">|</span> <span class="mi">2</span> <span class="p">-&gt;</span> <span class="nn">ActivationFunction</span><span class="p">.</span><span class="n">leakyReLU</span>
        <span class="p">|</span> <span class="p">_</span> <span class="p">-&gt;</span> <span class="nn">ActivationFunction</span><span class="p">.</span><span class="n">identity</span>

<span class="k">let</span> <span class="n">weightInitF</span> <span class="o">(_</span><span class="n">layerIndex</span><span class="p">:</span> <span class="kt">int</span><span class="o">):</span> <span class="kt">float</span> <span class="p">=</span>
        <span class="mi">1</span><span class="p">.</span><span class="mi">0</span> <span class="p">-</span> <span class="mi">2</span><span class="p">.</span><span class="mi">0</span> <span class="p">*</span> <span class="nn">System</span><span class="p">.</span><span class="nc">Random</span><span class="bp">()</span><span class="p">.</span><span class="nc">NextDouble</span><span class="bp">()</span>

<span class="k">let</span> <span class="n">customizedNetwork</span> <span class="p">=</span>
        <span class="nn">NeuralNetwork</span><span class="p">.</span><span class="n">customizedInit</span><span class="p">(</span>
            <span class="n">layers</span><span class="p">,</span>
            <span class="n">activationF</span><span class="p">,</span>
            <span class="n">weightInitF</span>
        <span class="p">)</span>
</code></pre><h2 id='save-and-load-a-neural-network'>Save and load a neural network</h2>
<p>JSON instances are <strong>compatible</strong> across platforms!
We can generate, train and save a neural network in Scala
and then load and make predictions in Javascript!</p>
<h3 id='tojson'>toJson</h3>
<p>Call <code>NeuralNetwork.toJson</code> on a neural network and get a string representation of it.
Use it as you like. Save <code>json</code> in the file system or insert into a database table.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">json</span> <span class="o">=</span> <span class="nx">NeuralNetwork</span><span class="p">.</span><span class="nx">toJson</span><span class="p">(</span><span class="nx">customizedNetwork</span><span class="p">);</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">String</span> <span class="n">json</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">customizedNetwork</span><span class="o">);</span>
</code></pre><pre class="highlight scala tab-scala"><code><span class="k">val</span> <span class="n">json</span> <span class="k">=</span> <span class="nc">NeuralNetwork</span><span class="o">.</span><span class="n">toJson</span><span class="o">(</span><span class="n">customizedNetwork</span><span class="o">)</span>
</code></pre><pre class="highlight fsharp tab-fsharp"><code><span class="k">let</span> <span class="n">json</span> <span class="p">=</span> <span class="nn">NeuralNetwork</span><span class="p">.</span><span class="n">toJson</span><span class="p">(</span><span class="n">customizedNetwork</span><span class="p">)</span>
</code></pre><h3 id='ofjson'>ofJson</h3><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">loadedNetwork</span> <span class="o">=</span> <span class="nx">NeuralNetwork</span><span class="p">.</span><span class="nx">ofJson</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">NeuralNetwork</span> <span class="n">loadedNetwork</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="o">.</span><span class="na">ofJson</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>
</code></pre><pre class="highlight scala tab-scala"><code><span class="k">val</span> <span class="n">loadedNetwork</span> <span class="k">=</span> <span class="nc">NeuralNetwork</span><span class="o">.</span><span class="n">ofJson</span><span class="o">(</span><span class="n">json</span><span class="o">)</span>
</code></pre><pre class="highlight fsharp tab-fsharp"><code><span class="k">let</span> <span class="n">loadedNetwork</span> <span class="p">=</span> <span class="nn">NeuralNetwork</span><span class="p">.</span><span class="n">ofJson</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>
</code></pre>
<p>As the name suggests, <code>NeuralNetwork.ofJson</code> turns a json string into a neural network.</p>
<h2 id='encoding-and-decoding'>Encoding and decoding</h2>
<p><em>One hot encoding</em> is a process that turns discrete attributes into a list of <em>0.0</em> and <em>1.0</em>.
<em>Minmax normalization</em> scales continuous attributes into values between <em>0.0</em> and <em>1.0</em>.
You can use <code>DataPreprocessor</code> for datapoint encoding and decoding.</p>

<p>The first parameter of <code>DataPreprocessor.init</code> is a list of tuples <em>(attributeName, discreteOrNot)</em>.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">setosaDatapoint</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">petal_length</span><span class="p">:</span> <span class="s2">"1.5"</span><span class="p">,</span>
    <span class="na">petal_width</span><span class="p">:</span> <span class="s2">"0.1"</span><span class="p">,</span>
    <span class="na">sepal_length</span><span class="p">:</span> <span class="s2">"4.9"</span><span class="p">,</span>
    <span class="na">sepal_width</span><span class="p">:</span> <span class="s2">"3.1"</span><span class="p">,</span>
    <span class="na">species</span><span class="p">:</span> <span class="s2">"setosa"</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">versicolorDatapoint</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">petal_length</span><span class="p">:</span> <span class="s2">"3.8"</span><span class="p">,</span>
    <span class="na">petal_width</span><span class="p">:</span> <span class="s2">"1.1"</span><span class="p">,</span>
    <span class="na">sepal_length</span><span class="p">:</span> <span class="s2">"5.5"</span><span class="p">,</span>
    <span class="na">sepal_width</span><span class="p">:</span> <span class="s2">"2.4"</span><span class="p">,</span>
    <span class="na">species</span><span class="p">:</span> <span class="s2">"versicolor"</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">virginicaDatapoint</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">petal_length</span><span class="p">:</span> <span class="s2">"6.0"</span><span class="p">,</span>
    <span class="na">petal_width</span><span class="p">:</span> <span class="s2">"2.2"</span><span class="p">,</span>
    <span class="na">sepal_length</span><span class="p">:</span> <span class="s2">"5.0"</span><span class="p">,</span>
    <span class="na">sepal_width</span><span class="p">:</span> <span class="s2">"1.5"</span><span class="p">,</span>
    <span class="na">species</span><span class="p">:</span> <span class="s2">"virginica"</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">datasetArr</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">setosaDatapoint</span><span class="p">,</span>
                   <span class="nx">versicolorDatapoint</span><span class="p">,</span>
                   <span class="nx">virginicaDatapoint</span> <span class="p">];</span>

<span class="kd">let</span> <span class="nx">datasetIter</span> <span class="o">=</span> <span class="nx">datasetArr</span><span class="p">[</span><span class="nx">Symbol</span><span class="p">.</span><span class="nx">iterator</span><span class="p">]();</span>

<span class="kd">let</span> <span class="nx">dataPreprocessor</span> <span class="o">=</span>
        <span class="nx">DataPreprocessor</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span>
             <span class="p">[</span> <span class="p">[</span><span class="s2">"petal_length"</span><span class="p">,</span> <span class="kc">false</span><span class="p">],</span>
               <span class="p">[</span><span class="s2">"petal_width"</span><span class="p">,</span> <span class="kc">false</span><span class="p">],</span>
               <span class="p">[</span><span class="s2">"sepal_length"</span><span class="p">,</span> <span class="kc">false</span><span class="p">],</span>
               <span class="p">[</span><span class="s2">"sepal_width"</span><span class="p">,</span> <span class="kc">false</span><span class="p">],</span>
               <span class="p">[</span><span class="s2">"species"</span><span class="p">,</span> <span class="kc">true</span><span class="p">]</span> <span class="p">],</span>
             <span class="nx">datasetIter</span>
        <span class="p">);</span>

<span class="kd">let</span> <span class="nx">encodedDatapoints</span> <span class="o">=</span> <span class="nx">datasetArr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span>
        <span class="nx">DataPreprocessor</span><span class="p">.</span><span class="nx">encodedDatapoint</span><span class="p">(</span><span class="nx">dataPreprocessor</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span>
<span class="p">);</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">setosaDatapoint</span> <span class="o">=</span>
        <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="o">{</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"petal_length"</span><span class="o">,</span> <span class="s">"1.5"</span><span class="o">);</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"petal_width"</span><span class="o">,</span> <span class="s">"0.1"</span><span class="o">);</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"sepal_length"</span><span class="o">,</span> <span class="s">"4.9"</span><span class="o">);</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"sepal_width"</span><span class="o">,</span> <span class="s">"3.1"</span><span class="o">);</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"species"</span><span class="o">,</span> <span class="s">"setosa"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">};</span>

<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">versicolorDatapoint</span> <span class="o">=</span>
        <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="o">{</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"petal_length"</span><span class="o">,</span> <span class="s">"3.8"</span><span class="o">);</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"petal_width"</span><span class="o">,</span> <span class="s">"1.1"</span><span class="o">);</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"sepal_length"</span><span class="o">,</span> <span class="s">"5.5"</span><span class="o">);</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"sepal_width"</span><span class="o">,</span> <span class="s">"2.4"</span><span class="o">);</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"species"</span><span class="o">,</span> <span class="s">"versicolor"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">};</span>

<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">virginicaDatapoint</span> <span class="o">=</span>
        <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="o">{</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"petal_length"</span><span class="o">,</span> <span class="s">"6.0"</span><span class="o">);</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"petal_width"</span><span class="o">,</span> <span class="s">"2.2"</span><span class="o">);</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"sepal_length"</span><span class="o">,</span> <span class="s">"5.0"</span><span class="o">);</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"sepal_width"</span><span class="o">,</span> <span class="s">"1.5"</span><span class="o">);</span>
                <span class="n">put</span><span class="o">(</span><span class="s">"species"</span><span class="o">,</span> <span class="s">"virginica"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">};</span>

<span class="n">Map</span><span class="o">[]</span> <span class="n">datasetArr</span> <span class="o">=</span> <span class="o">{</span>
        <span class="n">setosaDatapoint</span><span class="o">,</span>
        <span class="n">versicolorDatapoint</span><span class="o">,</span>
        <span class="n">virginicaDatapoint</span>
<span class="o">};</span>

<span class="n">Stream</span> <span class="n">datasetStream</span> <span class="o">=</span>
        <span class="n">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">datasetArr</span><span class="o">);</span>

<span class="n">DataPreprocessor</span> <span class="n">dataPreprocessor</span> <span class="o">=</span>
        <span class="n">DataPreprocessor</span><span class="o">.</span><span class="na">init</span><span class="o">(</span>
                <span class="k">new</span> <span class="n">Object</span><span class="o">[][]{</span>
                        <span class="o">{</span><span class="s">"petal_length"</span><span class="o">,</span> <span class="kc">false</span><span class="o">},</span>
                        <span class="o">{</span><span class="s">"petal_width"</span><span class="o">,</span> <span class="kc">false</span><span class="o">},</span>
                        <span class="o">{</span><span class="s">"sepal_length"</span><span class="o">,</span> <span class="kc">false</span><span class="o">},</span>
                        <span class="o">{</span><span class="s">"sepal_width"</span><span class="o">,</span> <span class="kc">false</span><span class="o">},</span>
                        <span class="o">{</span><span class="s">"species"</span><span class="o">,</span> <span class="kc">true</span><span class="o">}</span>
                <span class="o">},</span>
                <span class="n">datasetStream</span>
        <span class="o">);</span>

<span class="n">Stream</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">[]&gt;</span> <span class="n">encodedDatapoints</span> <span class="o">=</span> <span class="n">datasetStream</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">x</span> <span class="o">-&gt;</span>
    <span class="n">DataPreprocessor</span>
        <span class="o">.</span><span class="na">encodedDatapoint</span><span class="o">(</span>
            <span class="n">dataPreprocessor</span><span class="o">,</span> <span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;)</span> <span class="n">x</span>
        <span class="o">)</span>
<span class="o">);</span>
</code></pre><pre class="highlight scala tab-scala"><code><span class="k">val</span> <span class="n">setosaDatapoint</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span>
  <span class="s">"petal_length"</span> <span class="o">-&gt;</span> <span class="s">"1.5"</span><span class="o">,</span>
  <span class="s">"petal_width"</span> <span class="o">-&gt;</span> <span class="s">"0.1"</span><span class="o">,</span>
  <span class="s">"sepal_length"</span> <span class="o">-&gt;</span> <span class="s">"4.9"</span><span class="o">,</span>
  <span class="s">"sepal_width"</span> <span class="o">-&gt;</span> <span class="s">"3.1"</span><span class="o">,</span>
  <span class="s">"species"</span> <span class="o">-&gt;</span> <span class="s">"setosa"</span>
<span class="o">)</span>

<span class="k">val</span> <span class="n">versicolorDatapoint</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span>
  <span class="s">"petal_length"</span> <span class="o">-&gt;</span> <span class="s">"3.8"</span><span class="o">,</span>
  <span class="s">"petal_width"</span> <span class="o">-&gt;</span> <span class="s">"1.1"</span><span class="o">,</span>
  <span class="s">"sepal_length"</span> <span class="o">-&gt;</span> <span class="s">"5.5"</span><span class="o">,</span>
  <span class="s">"sepal_width"</span> <span class="o">-&gt;</span> <span class="s">"2.4"</span><span class="o">,</span>
  <span class="s">"species"</span> <span class="o">-&gt;</span> <span class="s">"versicolor"</span>
<span class="o">)</span>

<span class="k">val</span> <span class="n">virginicaDatapoint</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span>
  <span class="s">"petal_length"</span> <span class="o">-&gt;</span> <span class="s">"6.0"</span><span class="o">,</span>
  <span class="s">"petal_width"</span> <span class="o">-&gt;</span> <span class="s">"2.2"</span><span class="o">,</span>
  <span class="s">"sepal_length"</span> <span class="o">-&gt;</span> <span class="s">"5.0"</span><span class="o">,</span>
  <span class="s">"sepal_width"</span> <span class="o">-&gt;</span> <span class="s">"1.5"</span><span class="o">,</span>
  <span class="s">"species"</span> <span class="o">-&gt;</span> <span class="s">"virginica"</span>
<span class="o">)</span>

<span class="k">val</span> <span class="n">dataset</span> <span class="k">=</span> <span class="nc">LazyList</span><span class="o">(</span>
                        <span class="n">setosaDatapoint</span><span class="o">,</span>
                        <span class="n">versicolorDatapoint</span><span class="o">,</span>
                        <span class="n">virginicaDatapoint</span>
                      <span class="o">)</span>

<span class="k">val</span> <span class="n">dataPreprocessor</span> <span class="k">=</span>
        <span class="nc">DataPreprocessor</span><span class="o">.</span><span class="n">init</span><span class="o">(</span>
             <span class="nc">List</span><span class="o">(</span> <span class="o">(</span><span class="s">"petal_length"</span><span class="o">,</span> <span class="kc">false</span><span class="o">),</span>
                   <span class="o">(</span><span class="s">"petal_width"</span><span class="o">,</span> <span class="kc">false</span><span class="o">),</span>
                   <span class="o">(</span><span class="s">"sepal_length"</span><span class="o">,</span> <span class="kc">false</span><span class="o">),</span>
                   <span class="o">(</span><span class="s">"sepal_width"</span><span class="o">,</span> <span class="kc">false</span><span class="o">),</span>
                   <span class="o">(</span><span class="s">"species"</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span> <span class="o">),</span>
             <span class="n">dataset</span>
        <span class="o">)</span>

<span class="k">val</span> <span class="n">encodedDatapoints</span> <span class="k">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span>
        <span class="nc">DataPreprocessor</span><span class="o">.</span><span class="n">encodedDatapoint</span><span class="o">(</span><span class="n">dataPreprocessor</span><span class="o">,</span> <span class="n">x</span><span class="o">)</span>
<span class="o">)</span>
</code></pre><pre class="highlight fsharp tab-fsharp"><code><span class="k">let</span> <span class="n">setosaDatapoint</span> <span class="p">=</span>
        <span class="nn">Map</span><span class="p">.</span><span class="n">ofList</span>
            <span class="p">[</span> <span class="p">(</span><span class="s2">"petal_length"</span><span class="p">,</span> <span class="s2">"1.5"</span><span class="p">)</span>
              <span class="p">(</span><span class="s2">"petal_width"</span><span class="p">,</span> <span class="s2">"0.1"</span><span class="p">)</span>
              <span class="p">(</span><span class="s2">"sepal_length"</span><span class="p">,</span> <span class="s2">"4.9"</span><span class="p">)</span>
              <span class="p">(</span><span class="s2">"sepal_width"</span><span class="p">,</span> <span class="s2">"3.1"</span><span class="p">)</span>
              <span class="p">(</span><span class="s2">"species"</span><span class="p">,</span> <span class="s2">"setosa"</span><span class="p">)</span> <span class="p">]</span>

<span class="k">let</span> <span class="n">versicolorDatapoint</span> <span class="p">=</span>
        <span class="nn">Map</span><span class="p">.</span><span class="n">ofList</span>
            <span class="p">[</span> <span class="p">(</span><span class="s2">"petal_length"</span><span class="p">,</span> <span class="s2">"3.8"</span><span class="p">)</span>
              <span class="p">(</span><span class="s2">"petal_width"</span><span class="p">,</span> <span class="s2">"1.1"</span><span class="p">)</span>
              <span class="p">(</span><span class="s2">"sepal_length"</span><span class="p">,</span> <span class="s2">"5.5"</span><span class="p">)</span>
              <span class="p">(</span><span class="s2">"sepal_width"</span><span class="p">,</span> <span class="s2">"2.4"</span><span class="p">)</span>
              <span class="p">(</span><span class="s2">"species"</span><span class="p">,</span> <span class="s2">"versicolor"</span><span class="p">)</span> <span class="p">]</span>

<span class="k">let</span> <span class="n">virginicaDatapoint</span> <span class="p">=</span>
        <span class="nn">Map</span><span class="p">.</span><span class="n">ofList</span>
            <span class="p">[</span> <span class="p">(</span><span class="s2">"petal_length"</span><span class="p">,</span> <span class="s2">"6.0"</span><span class="p">)</span>
              <span class="p">(</span><span class="s2">"petal_width"</span><span class="p">,</span> <span class="s2">"2.2"</span><span class="p">)</span>
              <span class="p">(</span><span class="s2">"sepal_length"</span><span class="p">,</span> <span class="s2">"5.0"</span><span class="p">)</span>
              <span class="p">(</span><span class="s2">"sepal_width"</span><span class="p">,</span> <span class="s2">"1.5"</span><span class="p">)</span>
              <span class="p">(</span><span class="s2">"species"</span><span class="p">,</span> <span class="s2">"virginica"</span><span class="p">)</span> <span class="p">]</span>

<span class="k">let</span> <span class="n">dataset</span> <span class="p">=</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">ofList</span>
                <span class="p">[</span> <span class="n">setosaDatapoint</span>
                  <span class="n">versicolorDatapoint</span>
                  <span class="n">virginicaDatapoint</span> <span class="p">]</span>

<span class="k">let</span> <span class="n">dataPreprocessor</span> <span class="p">=</span>
        <span class="nn">DataPreprocessor</span><span class="p">.</span><span class="n">init</span><span class="p">(</span>
             <span class="p">[</span> <span class="p">(</span><span class="s2">"petal_length"</span><span class="p">,</span> <span class="bp">false</span><span class="p">)</span>
               <span class="p">(</span><span class="s2">"petal_width"</span><span class="p">,</span> <span class="bp">false</span><span class="p">)</span>
               <span class="p">(</span><span class="s2">"sepal_length"</span><span class="p">,</span> <span class="bp">false</span><span class="p">)</span>
               <span class="p">(</span><span class="s2">"sepal_width"</span><span class="p">,</span> <span class="bp">false</span><span class="p">)</span>
               <span class="p">(</span><span class="s2">"species"</span><span class="p">,</span> <span class="bp">true</span><span class="p">)</span> <span class="o">],</span>
             <span class="n">dataset</span>
        <span class="p">)</span>

<span class="k">let</span> <span class="n">encodedDatapoints</span> <span class="p">=</span>
        <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span> <span class="p">(</span><span class="k">fun</span> <span class="n">datapoint</span> <span class="p">-&gt;</span>
                    <span class="nn">DataPreprocessor</span><span class="p">.</span><span class="n">encodedDatapoint</span><span class="p">(</span><span class="n">dataPreprocessor</span><span class="p">,</span> <span class="n">datapoint</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">dataset</span>
</code></pre>
<blockquote>
<p><code>encodedDatapoints</code> equals to</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mf">0.0</span><span class="w">     </span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="w">     </span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="w">     </span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="w">     </span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="err">;</span><span class="w"> </span><span class="mf">0.0</span><span class="err">;</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="p">[</span><span class="w"> </span><span class="mf">0.511111</span><span class="p">,</span><span class="w"> </span><span class="mf">0.476190</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="w">     </span><span class="p">,</span><span class="w"> </span><span class="mf">0.562500</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="err">;</span><span class="w"> </span><span class="mf">1.0</span><span class="err">;</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="p">[</span><span class="w"> </span><span class="mf">1.0</span><span class="w">     </span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="w">     </span><span class="p">,</span><span class="w"> </span><span class="mf">0.166667</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="w">     </span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="err">;</span><span class="w"> </span><span class="mf">0.0</span><span class="err">;</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></code></pre>
<p>Save and load the preprocessor by calling <code>DataPreprocessor.toJson</code> and <code>DataPreprocessor.ofJson</code>.</p>
<h2 id='evaluation'>Evaluation</h2>
<p>To evaluate a neural network, you can call <code>Statistics.rootMeanSquareError</code> and provide the expected and predicted values.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">expectedWithOutputValuesArr</span> <span class="o">=</span>
        <span class="p">[</span> <span class="p">[</span> <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="p">],</span>
          <span class="p">[</span> <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="p">]</span> <span class="p">];</span>

<span class="kd">let</span> <span class="nx">expectedWithOutputValuesIter</span> <span class="o">=</span>
        <span class="nx">expectedWithOutputValuesArr</span><span class="p">[</span><span class="nx">Symbol</span><span class="p">.</span><span class="nx">iterator</span><span class="p">]();</span>

<span class="kd">let</span> <span class="nx">rmse</span> <span class="o">=</span> <span class="nx">Statistics</span><span class="p">.</span><span class="nx">rootMeanSquareError</span><span class="p">(</span>
                        <span class="nx">expectedWithOutputValuesIter</span>
<span class="p">);</span>
</code></pre><pre class="highlight java tab-java"><code><span class="kt">double</span><span class="o">[][][]</span> <span class="n">expectedWithOutputValuesArr</span> <span class="o">=</span> <span class="o">{</span>
        <span class="o">{{</span><span class="mf">0.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">},</span> <span class="o">{</span><span class="mf">0.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">}},</span>
        <span class="o">{{</span><span class="mf">0.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">},</span> <span class="o">{</span><span class="mf">0.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">}}</span>
<span class="o">};</span>

<span class="n">Stream</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">[][]&gt;</span> <span class="n">expectedWithOutputValuesStream</span> <span class="o">=</span>
    <span class="n">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">expectedWithOutputValuesArr</span><span class="o">);</span>

<span class="kt">double</span> <span class="n">rmse</span> <span class="o">=</span> <span class="n">Statistics</span>
    <span class="o">.</span><span class="na">rootMeanSquareError</span><span class="o">(</span><span class="n">expectedWithOutputValuesStream</span><span class="o">);</span>
</code></pre><pre class="highlight scala tab-scala"><code><span class="k">val</span> <span class="n">expectedWithOutputValues</span> <span class="k">=</span>
    <span class="nc">LazyList</span><span class="o">(</span>
      <span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mf">0.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mf">0.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">)),</span>
      <span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mf">0.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mf">0.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">))</span>
    <span class="o">)</span>

<span class="k">val</span> <span class="n">rmse</span> <span class="k">=</span> <span class="nc">Statistics</span><span class="o">.</span><span class="n">rootMeanSquareError</span><span class="o">(</span>
                        <span class="n">expectedWithOutputValues</span>
<span class="o">)</span>
</code></pre><pre class="highlight fsharp tab-fsharp"><code><span class="k">let</span> <span class="n">expectedWithOutputValues</span> <span class="p">=</span>
        <span class="nn">Seq</span><span class="p">.</span><span class="n">ofList</span> <span class="p">[</span> <span class="p">(</span> <span class="p">[</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">],</span> <span class="p">[</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
                     <span class="p">(</span> <span class="p">[</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="o">],</span> <span class="p">[</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">]</span>

<span class="k">let</span> <span class="n">rmse</span> <span class="p">=</span> <span class="nn">Statistics</span><span class="p">.</span><span class="n">rootMeanSquareError</span><span class="p">(</span>
                        <span class="n">expectedWithOutputValues</span>
<span class="p">)</span>
</code></pre>
      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
                <a href="#" data-language-name="java">java</a>
                <a href="#" data-language-name="scala">scala</a>
                <a href="#" data-language-name="fsharp">fsharp</a>
          </div>
      </div>
    </div>
  </body>
</html>
